with col2:
        if run_btn:
            # ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡πÉ‡∏ä‡πâ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏õ‡∏£‡∏∞‡∏°‡∏ß‡∏•‡∏ú‡∏• Logic (v_out = ‡∏ú‡∏•‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå 5 ‡∏Ç‡πâ‡∏≠, r_out = ‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏ä‡∏∏‡∏î‡∏ó‡∏µ‡πà‡∏Ñ‡∏ß‡∏£‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°)
            v_out, r_out, img_url = process_logic(api_key, country, activity, gender, (end_date-start_date).days, use_free_mode, img_file, lang)
            
            # --- ‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏µ‡πà 1: AI Critique & Analysis (‡∏ú‡∏•‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏à‡∏≤‡∏Å‡∏£‡∏π‡∏õ‡∏ó‡∏µ‡πà‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î) ---
            st.markdown("### üîç AI Critique & Analysis")
            st.markdown(f'<div class="analysis-box">{v_out}</div>', unsafe_allow_html=True)
            st.divider()

            # --- ‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏µ‡πà 2: Outfit Visual (‡πÅ‡∏™‡∏î‡∏á‡∏†‡∏≤‡∏û 3D) ---
            st.markdown("### üé≠ Outfit Visual")
            if img_url: 
                st.image(img_url, caption="‡∏†‡∏≤‡∏û‡∏à‡∏≥‡∏•‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÅ‡∏ï‡πà‡∏á‡∏Å‡∏≤‡∏¢‡∏ó‡∏µ‡πà‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏°‡∏™‡∏≠‡∏î‡∏Ñ‡∏•‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ö‡∏ú‡∏•‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå", use_container_width=True)
            
            # --- ‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏µ‡πà 3: Outfit Plan (‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏ä‡∏∏‡∏î‡∏ó‡∏µ‡πà‡∏Ñ‡∏ß‡∏£‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏° - ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏ä‡∏∑‡πà‡∏≠‡∏ß‡∏±‡∏ô) ---
            st.markdown("### üìã ‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏ä‡∏∏‡∏î‡∏ó‡∏µ‡πà‡∏Ñ‡∏ß‡∏£‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°")
            st.info(r_out)
            st.divider()

            # --- ‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏µ‡πà 4: ‡πÅ‡∏´‡∏•‡πà‡∏á‡∏ä‡πâ‡∏≠‡∏õ‡∏õ‡∏¥‡πâ‡∏á‡πÅ‡∏•‡∏∞‡πÑ‡∏≠‡πÄ‡∏ó‡∏°‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥ (‡πÅ‡∏¢‡∏Å‡∏ï‡∏≤‡∏° 5 ‡∏™‡πà‡∏ß‡∏ô‡∏´‡∏•‡∏±‡∏Å‡∏à‡∏≤‡∏Å‡∏Å‡∏≤‡∏£‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå) ---
            st.markdown("### üõçÔ∏è ‡πÅ‡∏´‡∏•‡πà‡∏á‡∏ä‡πâ‡∏≠‡∏õ‡∏õ‡∏¥‡πâ‡∏á‡πÅ‡∏•‡∏∞‡πÑ‡∏≠‡πÄ‡∏ó‡∏°‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥")
            st.write("‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ã‡∏∑‡πâ‡∏≠‡πÑ‡∏≠‡πÄ‡∏ó‡∏°‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏ï‡∏¥‡∏°‡πÄ‡∏ï‡πá‡∏°‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏µ‡πà‡∏¢‡∏±‡∏á‡∏Ç‡∏≤‡∏î‡∏ï‡∏≤‡∏°‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏Ç‡∏≠‡∏á AI:")
            
            # ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤ 5 ‡∏™‡πà‡∏ß‡∏ô‡∏´‡∏•‡∏±‡∏Å ‡∏≠‡πâ‡∏≤‡∏á‡∏≠‡∏¥‡∏á‡∏ï‡∏≤‡∏°‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠‡∏Å‡∏≤‡∏£‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå
            shop_categories = [
                {"name": "‡πÄ‡∏™‡∏∑‡πâ‡∏≠‡∏ú‡πâ‡∏≤‡∏ä‡∏±‡πâ‡∏ô‡∏ô‡∏≠‡∏Å (Coats/Jackets)", "icon": "üß•", "ref": "1"},
                {"name": "‡∏Å‡∏≤‡∏á‡πÄ‡∏Å‡∏á‡πÅ‡∏•‡∏∞‡πÄ‡∏•‡∏Å‡∏Å‡∏¥‡πâ‡∏á (Pants/Leggings)", "icon": "üëñ", "ref": "2"},
                {"name": "‡∏´‡∏°‡∏ß‡∏Å‡πÅ‡∏•‡∏∞‡∏ú‡πâ‡∏≤‡∏û‡∏±‡∏ô‡∏Ñ‡∏≠ (Headwear/Scarf)", "icon": "üß£", "ref": "3"},
                {"name": "‡∏£‡∏≠‡∏á‡πÄ‡∏ó‡πâ‡∏≤‡πÅ‡∏•‡∏∞‡∏ö‡∏π‡∏ó (Footwear/Boots)", "icon": "ü•æ", "ref": "4"},
                {"name": "‡∏ñ‡∏∏‡∏á‡∏°‡∏∑‡∏≠‡πÅ‡∏•‡∏∞‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡πÄ‡∏™‡∏£‡∏¥‡∏° (Gloves/Heat Packs)", "icon": "üß§", "ref": "5"}
            ]

            for cat in shop_categories:
                st.markdown(f"""
                    <div class="shop-item">
                        <small style="color: #4f46e5;">‡∏≠‡πâ‡∏≤‡∏á‡∏≠‡∏¥‡∏á‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏ó‡∏µ‡πà {cat['ref']}</small><br>
                        <strong>{cat['icon']} {cat['name']}</strong><br>
                        <div style="margin-top: 8px;">
                            <a href='https://shopee.co.th/search?keyword={quote_plus(cat['name'])}' target='_blank' style='text-decoration:none; color:#4f46e5; font-size:14px;'>üõí Shopee</a> | 
                            <a href='https://www.lazada.co.th/catalog/?q={quote_plus(cat['name'])}' target='_blank' style='text-decoration:none; color:#4f46e5; font-size:14px; margin-left:10px;'>üõí Lazada</a>
                        </div>
                    </div>
                """, unsafe_allow_html=True)
        else:
            st.info("üëà ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÉ‡∏™‡πà‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÅ‡∏•‡∏∞‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡∏£‡∏π‡∏õ‡∏ä‡∏∏‡∏î‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏Å‡∏≤‡∏£‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå")
